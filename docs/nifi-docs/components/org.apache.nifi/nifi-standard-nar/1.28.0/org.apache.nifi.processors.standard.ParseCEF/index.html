<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"></meta><title>ParseCEF</title><link rel="stylesheet" href="../../../../../css/component-usage.css" type="text/css"></link></head><script type="text/javascript">window.onload = function(){if(self==top) { document.getElementById('nameHeader').style.display = "inherit"; } }</script><body><h1 id="nameHeader" style="display: none;">ParseCEF</h1><h2>Deprecation notice: </h2><p>This component is deprecated and will be removed in NiFi 2.x.</p><p>Please consider using one the following alternatives: No alternative components suggested.</p><h2>Description: </h2><p>Parses the contents of a CEF formatted message and adds attributes to the FlowFile for headers and extensions of the parts of the CEF message.
Note: This Processor expects CEF messages WITHOUT the syslog headers (i.e. starting at "CEF:0"</p><h3>Tags: </h3><p>logs, cef, attributes, system, event, message</p><h3>Properties: </h3><p>In the list below, the names of required properties appear in <strong>bold</strong>. Any other properties (not in bold) are considered optional. The table also indicates any default values.</p><table id="properties"><tr><th>Display Name</th><th>API Name</th><th>Default Value</th><th>Allowable Values</th><th>Description</th></tr><tr><td id="name"><strong>Parsed fields destination</strong></td><td>FIELDS_DESTINATION</td><td id="default-value">flowfile-content</td><td id="allowable-values"><ul><li>flowfile-content</li><li>flowfile-attribute</li></ul></td><td id="description">Indicates whether the results of the CEF parser are written to the FlowFile content or a FlowFile attribute; if using flowfile-attributeattribute, fields will be populated as attributes. If set to flowfile-content, the CEF extension field will be converted into a flat JSON object.</td></tr><tr><td id="name"><strong>Append raw message to JSON</strong></td><td>APPEND_RAW_MESSAGE_TO_JSON</td><td id="default-value">true</td><td id="allowable-values"></td><td id="description">When using flowfile-content (i.e. JSON output), add the original CEF message to the resulting JSON object. The original message is added as a string to _raw.</td></tr><tr><td id="name"><strong>Include custom extensions</strong></td><td>INCLUDE_CUSTOM_EXTENSIONS</td><td id="default-value">false</td><td id="allowable-values"><ul><li>true</li><li>false</li></ul></td><td id="description">If set to true, custom extensions (not specified in the CEF specifications) will be included in the generated data/attributes.</td></tr><tr><td id="name"><strong>Accept empty extensions</strong></td><td>ACCEPT_EMPTY_EXTENSIONS</td><td id="default-value">false</td><td id="allowable-values"><ul><li>true</li><li>false</li></ul></td><td id="description">If set to true, empty extensions will be accepted and will be associated to a null value.</td></tr><tr><td id="name"><strong>Validate the CEF event</strong></td><td>VALIDATE_DATA</td><td id="default-value">true</td><td id="allowable-values"><ul><li>true</li><li>false</li></ul></td><td id="description">If set to true, the event will be validated against the CEF standard (revision 23). If the event is invalid, the FlowFile will be routed to the failure relationship. If this property is set to false, the event will be processed without validating the data.</td></tr><tr><td id="name"><strong>Timezone</strong></td><td>TIME_REPRESENTATION</td><td id="default-value">Local Timezone (system Default)</td><td id="allowable-values"><ul><li>UTC</li><li>Local Timezone (system Default)</li></ul></td><td id="description">Timezone to be used when representing date fields. UTC will convert all dates to UTC, while Local Timezone will convert them to the timezone used by NiFi.</td></tr><tr><td id="name"><strong>DateTime Locale</strong></td><td>DATETIME_REPRESENTATION</td><td id="default-value">en-US</td><td id="allowable-values"></td><td id="description">The IETF BCP 47 representation of the Locale to be used when parsing date fields with long or short month names (e.g. may &lt;en-US&gt; vs. mai. &lt;fr-FR&gt;. The defaultvalue is generally safe. Only change if having issues parsing CEF messages</td></tr></table><h3>Relationships: </h3><table id="relationships"><tr><th>Name</th><th>Description</th></tr><tr><td>success</td><td>Any FlowFile that is successfully parsed as a CEF message will be transferred to this Relationship.</td></tr><tr><td>failure</td><td>Any FlowFile that could not be parsed as a CEF message will be transferred to this Relationship without any attributes being added</td></tr></table><h3>Reads Attributes: </h3>None specified.<h3>Writes Attributes: </h3><table id="writes-attributes"><tr><th>Name</th><th>Description</th></tr><tr><td>cef.header.version</td><td>The version of the CEF message.</td></tr><tr><td>cef.header.deviceVendor</td><td>The Device Vendor of the CEF message.</td></tr><tr><td>cef.header.deviceProduct</td><td>The Device Product of the CEF message.</td></tr><tr><td>cef.header.deviceVersion</td><td>The Device Version of the CEF message.</td></tr><tr><td>cef.header.deviceEventClassId</td><td>The Device Event Class ID of the CEF message.</td></tr><tr><td>cef.header.name</td><td>The name of the CEF message.</td></tr><tr><td>cef.header.severity</td><td>The severity of the CEF message.</td></tr><tr><td>cef.extension.*</td><td>The key and value generated by the parsing of the message.</td></tr></table><h3>State management: </h3>This component does not store state.<h3>Restricted: </h3>This component is not restricted.<h3>Input requirement: </h3>This component requires an incoming relationship.<h3>System Resource Considerations:</h3>None specified.<h3>See Also:</h3><p><a href="../org.apache.nifi.processors.standard.ParseSyslog/index.html">ParseSyslog</a></p></body></html>