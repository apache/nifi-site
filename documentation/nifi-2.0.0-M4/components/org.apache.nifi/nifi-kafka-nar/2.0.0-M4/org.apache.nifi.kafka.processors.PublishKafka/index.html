<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"></meta><title>PublishKafka</title><link rel="stylesheet" href="../../../../../css/component-usage.css" type="text/css"></link></head><script type="text/javascript">window.onload = function(){if(self==top) { document.getElementById('nameHeader').style.display = "inherit"; } }</script><body><h1 id="nameHeader" style="display: none;">PublishKafka</h1><h2>Description: </h2><p>Sends the contents of a FlowFile as either a message or as individual records to Apache Kafka using the Kafka Producer API. The messages to send may be individual FlowFiles, may be delimited using a user-specified delimiter (such as a new-line), or may be record-oriented data that can be read by the configured Record Reader. The complementary NiFi processor for fetching messages is ConsumeKafka.</p><h3>Tags: </h3><p>Apache, Kafka, Record, csv, json, avro, logs, Put, Send, Message, PubSub</p><h3>Properties: </h3><p>In the list below, the names of required properties appear in <strong>bold</strong>. Any other properties (not in bold) are considered optional. The table also indicates any default values, and whether a property supports the <a href="../../../../../html/expression-language-guide.html">NiFi Expression Language</a>.</p><table id="properties"><tr><th>Display Name</th><th>API Name</th><th>Default Value</th><th>Allowable Values</th><th>Description</th></tr><tr><td id="name"><strong>Kafka Connection Service</strong></td><td>Kafka Connection Service</td><td></td><td id="allowable-values"><strong>Controller Service API: </strong><br/>KafkaConnectionService<br/><strong>Implementation: </strong><a href="../../../nifi-kafka-3-service-nar/2.0.0-M4/org.apache.nifi.kafka.service.Kafka3ConnectionService/index.html">Kafka3ConnectionService</a></td><td id="description">Provides connections to Kafka Broker for publishing Kafka Records</td></tr><tr><td id="name"><strong>Topic Name</strong></td><td>Topic Name</td><td></td><td id="allowable-values"></td><td id="description">Name of the Kafka Topic to which the Processor publishes Kafka Records<br/><strong>Supports Expression Language: true (will be evaluated using flow file attributes and Environment variables)</strong></td></tr><tr><td id="name"><strong>Failure Strategy</strong></td><td>Failure Strategy</td><td id="default-value">Route to Failure</td><td id="allowable-values"><ul><li>Route to Failure <img src="../../../../../html/images/iconInfo.png" alt="When unable to publish records to Kafka, the FlowFile will be routed to the failure relationship." title="When unable to publish records to Kafka, the FlowFile will be routed to the failure relationship."></img></li><li>Rollback <img src="../../../../../html/images/iconInfo.png" alt="When unable to publish records to Kafka, the FlowFile will be placed back on the queue so that it will be retried. For flows where FlowFile ordering is important, this strategy can be used along with ensuring that the each processor uses only a single Concurrent Task." title="When unable to publish records to Kafka, the FlowFile will be placed back on the queue so that it will be retried. For flows where FlowFile ordering is important, this strategy can be used along with ensuring that the each processor uses only a single Concurrent Task."></img></li></ul></td><td id="description">Specifies how the processor handles a FlowFile if it is unable to publish the data to Kafka</td></tr><tr><td id="name"><strong>Delivery Guarantee</strong></td><td>acks</td><td id="default-value">Guarantee Replicated Delivery</td><td id="allowable-values"><ul><li>Guarantee Replicated Delivery <img src="../../../../../html/images/iconInfo.png" alt="FlowFile will be routed to failure unless the message is replicated to the appropriate number of Kafka Nodes according to the Topic configuration" title="FlowFile will be routed to failure unless the message is replicated to the appropriate number of Kafka Nodes according to the Topic configuration"></img></li><li>Guarantee Single Node Delivery <img src="../../../../../html/images/iconInfo.png" alt="FlowFile will be routed to success if the message is received by a single Kafka node, whether or not it is replicated. This is faster than &lt;Guarantee Replicated Delivery&gt; but can result in data loss if a Kafka node crashes" title="FlowFile will be routed to success if the message is received by a single Kafka node, whether or not it is replicated. This is faster than &lt;Guarantee Replicated Delivery&gt; but can result in data loss if a Kafka node crashes"></img></li><li>Best Effort <img src="../../../../../html/images/iconInfo.png" alt="FlowFile will be routed to success after successfully sending the content to a Kafka node, without waiting for any acknowledgment from the node at all. This provides the best performance but may result in data loss." title="FlowFile will be routed to success after successfully sending the content to a Kafka node, without waiting for any acknowledgment from the node at all. This provides the best performance but may result in data loss."></img></li></ul></td><td id="description">Specifies the requirement for guaranteeing that a message is sent to Kafka. Corresponds to Kafka Client acks property.</td></tr><tr><td id="name"><strong>Compression Type</strong></td><td>compression.type</td><td id="default-value">none</td><td id="allowable-values"><ul><li>none</li><li>gzip</li><li>snappy</li><li>lz4</li></ul></td><td id="description">Specifies the compression strategy for records sent to Kafka. Corresponds to Kafka Client compression.type property.</td></tr><tr><td id="name"><strong>Max Request Size</strong></td><td>max.request.size</td><td id="default-value">1 MB</td><td id="allowable-values"></td><td id="description">The maximum size of a request in bytes. Corresponds to Kafka Client max.request.size property.</td></tr><tr><td id="name"><strong>Transactions Enabled</strong></td><td>Transactions Enabled</td><td id="default-value">true</td><td id="allowable-values"><ul><li>true</li><li>false</li></ul></td><td id="description">Specifies whether to provide transactional guarantees when communicating with Kafka. If there is a problem sending data to Kafka, and this property is set to false, then the messages that have already been sent to Kafka will continue on and be delivered to consumers. If this is set to true, then the Kafka transaction will be rolled back so that those messages are not available to consumers. Setting this to true requires that the [Delivery Guarantee] property be set to [Guarantee Replicated Delivery.]</td></tr><tr><td id="name">Transactional ID Prefix</td><td>Transactional ID Prefix</td><td></td><td id="allowable-values"></td><td id="description">Specifies the KafkaProducer config transactional.id will be a generated UUID and will be prefixed with the configured string.<br/><strong>Supports Expression Language: true (will be evaluated using Environment variables only)</strong><br/><br/><strong>This Property is only considered if </strong><strong>the [Transactions Enabled] Property has a value of "true".</strong></td></tr><tr><td id="name"><strong>Partitioner Class</strong></td><td>partitioner.class</td><td id="default-value">DefaultPartitioner</td><td id="allowable-values"><ul><li>RoundRobinPartitioner <img src="../../../../../html/images/iconInfo.png" alt="Messages will be assigned partitions in a round-robin fashion, sending the first message to Partition 1, the next Partition to Partition 2, and so on, wrapping as necessary." title="Messages will be assigned partitions in a round-robin fashion, sending the first message to Partition 1, the next Partition to Partition 2, and so on, wrapping as necessary."></img></li><li>DefaultPartitioner <img src="../../../../../html/images/iconInfo.png" alt="The default partitioning strategy will choose the sticky partition that changes when the batch is full (See KIP-480 for details about sticky partitioning)." title="The default partitioning strategy will choose the sticky partition that changes when the batch is full (See KIP-480 for details about sticky partitioning)."></img></li><li>Expression Language Partitioner <img src="../../../../../html/images/iconInfo.png" alt="Interprets the &lt;Partition&gt; property as Expression Language that will be evaluated against each FlowFile. This Expression will be evaluated once against the FlowFile, so all Records in a given FlowFile will go to the same partition." title="Interprets the &lt;Partition&gt; property as Expression Language that will be evaluated against each FlowFile. This Expression will be evaluated once against the FlowFile, so all Records in a given FlowFile will go to the same partition."></img></li></ul></td><td id="description">Specifies which class to use to compute a partition id for a message. Corresponds to Kafka Client partitioner.class property.</td></tr><tr><td id="name">Partition</td><td>partition</td><td></td><td id="allowable-values"></td><td id="description">Specifies the Kafka Partition destination for Records.<br/><strong>Supports Expression Language: true (will be evaluated using flow file attributes and Environment variables)</strong></td></tr><tr><td id="name">Message Demarcator</td><td>Message Demarcator</td><td></td><td id="allowable-values"></td><td id="description">Specifies the string (interpreted as UTF-8) to use for demarcating multiple messages within a single FlowFile. If not specified, the entire content of the FlowFile will be used as a single message. If specified, the contents of the FlowFile will be split on this delimiter and each section sent as a separate Kafka message. To enter special character such as 'new line' use CTRL+Enter or Shift+Enter, depending on your OS.<br/><strong>Supports Expression Language: true (will be evaluated using flow file attributes and Environment variables)</strong></td></tr><tr><td id="name">Record Reader</td><td>Record Reader</td><td></td><td id="allowable-values"><strong>Controller Service API: </strong><br/>RecordReaderFactory<br/><strong>Implementations: </strong><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.json.JsonPathReader/index.html">JsonPathReader</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.syslog.Syslog5424Reader/index.html">Syslog5424Reader</a><br/><a href="../../../nifi-scripting-nar/2.0.0-M4/org.apache.nifi.record.script.ScriptedReader/index.html">ScriptedReader</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.cef.CEFReader/index.html">CEFReader</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.avro.AvroReader/index.html">AvroReader</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.csv.CSVReader/index.html">CSVReader</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.json.JsonTreeReader/index.html">JsonTreeReader</a><br/><a href="../../../nifi-protobuf-services-nar/2.0.0-M4/org.apache.nifi.services.protobuf.ProtobufReader/index.html">ProtobufReader</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.windowsevent.WindowsEventLogReader/index.html">WindowsEventLogReader</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.syslog.SyslogReader/index.html">SyslogReader</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.xml.XMLReader/index.html">XMLReader</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.lookup.ReaderLookup/index.html">ReaderLookup</a><br/><a href="../../../nifi-poi-nar/2.0.0-M4/org.apache.nifi.excel.ExcelReader/index.html">ExcelReader</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.yaml.YamlTreeReader/index.html">YamlTreeReader</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.grok.GrokReader/index.html">GrokReader</a></td><td id="description">The Record Reader to use for incoming FlowFiles</td></tr><tr><td id="name">Record Writer</td><td>Record Writer</td><td></td><td id="allowable-values"><strong>Controller Service API: </strong><br/>RecordSetWriterFactory<br/><strong>Implementations: </strong><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.lookup.RecordSetWriterLookup/index.html">RecordSetWriterLookup</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.avro.AvroRecordSetWriter/index.html">AvroRecordSetWriter</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.text.FreeFormTextRecordSetWriter/index.html">FreeFormTextRecordSetWriter</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.json.JsonRecordSetWriter/index.html">JsonRecordSetWriter</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.xml.XMLRecordSetWriter/index.html">XMLRecordSetWriter</a><br/><a href="../../../nifi-scripting-nar/2.0.0-M4/org.apache.nifi.record.script.ScriptedRecordSetWriter/index.html">ScriptedRecordSetWriter</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.csv.CSVRecordSetWriter/index.html">CSVRecordSetWriter</a></td><td id="description">The Record Writer to use in order to serialize the data before sending to Kafka</td></tr><tr><td id="name"><strong>Publish Strategy</strong></td><td>Publish Strategy</td><td id="default-value">Use Content as Record Value</td><td id="allowable-values"><ul><li>Use Content as Record Value <img src="../../../../../html/images/iconInfo.png" alt="Write only the FlowFile content to the Kafka Record value." title="Write only the FlowFile content to the Kafka Record value."></img></li><li>Use Wrapper <img src="../../../../../html/images/iconInfo.png" alt="Write the Kafka Record key, value, headers, and metadata into the Kafka Record value.  (See processor usage for more information.)" title="Write the Kafka Record key, value, headers, and metadata into the Kafka Record value.  (See processor usage for more information.)"></img></li></ul></td><td id="description">The format used to publish the incoming FlowFile record to Kafka.</td></tr><tr><td id="name">Message Key Field</td><td>Message Key Field</td><td></td><td id="allowable-values"></td><td id="description">The name of a field in the Input Records that should be used as the Key for the Kafka message.<br/><strong>Supports Expression Language: true (will be evaluated using flow file attributes and Environment variables)</strong><br/><br/><strong>This Property is only considered if </strong><strong>the [Publish Strategy] Property has a value of "Use Content as Record Value".</strong></td></tr><tr><td id="name">FlowFile Attribute Header Pattern</td><td>FlowFile Attribute Header Pattern</td><td></td><td id="allowable-values"></td><td id="description">A Regular Expression that is matched against all FlowFile attribute names. Any attribute whose name matches the pattern will be added to the Kafka messages as a Header. If not specified, no FlowFile attributes will be added as headers.<br/><br/><strong>This Property is only considered if </strong><strong>the [Publish Strategy] Property has a value of "Use Content as Record Value".</strong></td></tr><tr><td id="name"><strong>Header Encoding</strong></td><td>Header Encoding</td><td id="default-value">UTF-8</td><td id="allowable-values"></td><td id="description">For any attribute that is added as a Kafka Record Header, this property indicates the Character Encoding to use for serializing the headers.<br/><br/><strong>This Property is only considered if </strong><strong>the [FlowFile Attribute Header Pattern] Property has a value specified.</strong></td></tr><tr><td id="name">Kafka Key</td><td>Kafka Key</td><td></td><td id="allowable-values"></td><td id="description">The Key to use for the Message. If not specified, the FlowFile attribute 'kafka.key' is used as the message key, if it is present.Beware that setting Kafka key and demarcating at the same time may potentially lead to many Kafka messages with the same key.Normally this is not a problem as Kafka does not enforce or assume message and key uniqueness. Still, setting the demarcator and Kafka key at the same time poses a risk of data loss on Kafka. During a topic compaction on Kafka, messages will be deduplicated based on this key.<br/><strong>Supports Expression Language: true (will be evaluated using flow file attributes and Environment variables)</strong><br/><br/><strong>This Property is only considered if </strong><strong>the [Publish Strategy] Property has a value of "Use Wrapper".</strong></td></tr><tr><td id="name"><strong>Kafka Key Attribute Encoding</strong></td><td>Kafka Key Attribute Encoding</td><td id="default-value">UTF-8 Encoded</td><td id="allowable-values"><ul><li>UTF-8 Encoded <img src="../../../../../html/images/iconInfo.png" alt="The key is interpreted as a UTF-8 Encoded string." title="The key is interpreted as a UTF-8 Encoded string."></img></li><li>Hex Encoded <img src="../../../../../html/images/iconInfo.png" alt="The key is interpreted as arbitrary binary data and is encoded using hexadecimal characters with uppercase letters" title="The key is interpreted as arbitrary binary data and is encoded using hexadecimal characters with uppercase letters"></img></li><li>Do Not Add Key as Attribute <img src="../../../../../html/images/iconInfo.png" alt="The key will not be added as an Attribute" title="The key will not be added as an Attribute"></img></li></ul></td><td id="description">FlowFiles that are emitted have an attribute named 'kafka.key'. This property dictates how the value of the attribute should be encoded.<br/><br/><strong>This Property is only considered if </strong><strong>the [Publish Strategy] Property has a value of "Use Wrapper".</strong></td></tr><tr><td id="name">Record Key Writer</td><td>Record Key Writer</td><td></td><td id="allowable-values"><strong>Controller Service API: </strong><br/>RecordSetWriterFactory<br/><strong>Implementations: </strong><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.lookup.RecordSetWriterLookup/index.html">RecordSetWriterLookup</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.avro.AvroRecordSetWriter/index.html">AvroRecordSetWriter</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.text.FreeFormTextRecordSetWriter/index.html">FreeFormTextRecordSetWriter</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.json.JsonRecordSetWriter/index.html">JsonRecordSetWriter</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.xml.XMLRecordSetWriter/index.html">XMLRecordSetWriter</a><br/><a href="../../../nifi-scripting-nar/2.0.0-M4/org.apache.nifi.record.script.ScriptedRecordSetWriter/index.html">ScriptedRecordSetWriter</a><br/><a href="../../../nifi-record-serialization-services-nar/2.0.0-M4/org.apache.nifi.csv.CSVRecordSetWriter/index.html">CSVRecordSetWriter</a></td><td id="description">The Record Key Writer to use for outgoing FlowFiles<br/><br/><strong>This Property is only considered if </strong><strong>the [Publish Strategy] Property has a value of "Use Wrapper".</strong></td></tr><tr><td id="name"><strong>Record Metadata Strategy</strong></td><td>Record Metadata Strategy</td><td id="default-value">Use Configured Values</td><td id="allowable-values"><ul><li>Metadata From Record <img src="../../../../../html/images/iconInfo.png" alt="The Kafka Record's Topic and Partition will be determined by looking at the /metadata/topic and /metadata/partition fields of the Record, respectively. If these fields are invalid or not present, the Topic Name and Partition/Partitioner class properties of the processor will be considered." title="The Kafka Record's Topic and Partition will be determined by looking at the /metadata/topic and /metadata/partition fields of the Record, respectively. If these fields are invalid or not present, the Topic Name and Partition/Partitioner class properties of the processor will be considered."></img></li><li>Use Configured Values <img src="../../../../../html/images/iconInfo.png" alt="The Kafka Record's Topic will be determined using the 'Topic Name' processor property. The partition will be determined using the 'Partition' and 'Partitioner class' properties." title="The Kafka Record's Topic will be determined using the 'Topic Name' processor property. The partition will be determined using the 'Partition' and 'Partitioner class' properties."></img></li></ul></td><td id="description">Specifies whether the Record's metadata (topic and partition) should come from the Record's metadata field or if it should come from the configured Topic Name and Partition / Partitioner class properties<br/><br/><strong>This Property is only considered if </strong><strong>the [Publish Strategy] Property has a value of "Use Wrapper".</strong></td></tr></table><h3>Relationships: </h3><table id="relationships"><tr><th>Name</th><th>Description</th></tr><tr><td>failure</td><td>Any FlowFile that cannot be sent to Kafka will be routed to this Relationship</td></tr><tr><td>success</td><td>FlowFiles for which all content was sent to Kafka.</td></tr></table><h3>Reads Attributes: </h3><table id="reads-attributes"><tr><th>Name</th><th>Description</th></tr><tr><td>kafka.tombstone</td><td>If this attribute is set to 'true', if the processor is not configured with a demarcator and if the FlowFile's content is null, then a tombstone message with zero bytes will be sent to Kafka.</td></tr></table><h3>Writes Attributes: </h3><table id="writes-attributes"><tr><th>Name</th><th>Description</th></tr><tr><td>msg.count</td><td>The number of messages that were sent to Kafka for this FlowFile. This attribute is added only to FlowFiles that are routed to success.</td></tr></table><h3>State management: </h3>This component does not store state.<h3>Restricted: </h3>This component is not restricted.<h3>Input requirement: </h3>This component requires an incoming relationship.<h3>System Resource Considerations:</h3>None specified.<h3>See Also:</h3><p><a href="../org.apache.nifi.kafka.processors.ConsumeKafka/index.html">ConsumeKafka</a></p></body></html>